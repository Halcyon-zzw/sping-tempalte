# .ftl æ¨¡æ¿è‡ªå®šä¹‰å˜é‡ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æ˜¯çš„ï¼`.ftl` æ¨¡æ¿å¯ä»¥è¯»å– `CodeGenerator.java` ä¸­å®šä¹‰çš„å˜é‡ã€‚MyBatis-Plus Generator æ”¯æŒé€šè¿‡ `customMap` ä¼ é€’è‡ªå®šä¹‰å˜é‡åˆ°æ‰€æœ‰æ¨¡æ¿æ–‡ä»¶ã€‚

---

## âœ… å·²é…ç½®çš„è‡ªå®šä¹‰å˜é‡

åœ¨å½“å‰é¡¹ç›®çš„ `CodeGenerator.java` ä¸­ï¼Œå·²ç»é…ç½®äº†ä»¥ä¸‹è‡ªå®šä¹‰å˜é‡ï¼š

```java
Map<String, Object> customMap = new HashMap<>();
customMap.put("projectName", "Spring Template Project");
customMap.put("moduleName", "ä¸šåŠ¡æ¨¡å—");
customMap.put("apiVersion", "v1");
customMap.put("enableCache", false);
customMap.put("enableLog", true);
customMap.put("companyName", "å¼€å‘å›¢é˜Ÿ");
customMap.put("copyright", "Copyright Â© 2025");
```

---

## ğŸ“– åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨è‡ªå®šä¹‰å˜é‡

### 1. åŸºæœ¬ç”¨æ³•

åœ¨ä»»ä½• `.ftl` æ¨¡æ¿æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨ `${customMap.å˜é‡å}` è®¿é—®ï¼š

```ftl
/**
 * é¡¹ç›®åç§°: ${customMap.projectName}
 * æ¨¡å—åç§°: ${customMap.moduleName}
 * ç‰ˆæƒä¿¡æ¯: ${customMap.copyright}
 */
```

### 2. å®‰å…¨æ£€æŸ¥ï¼ˆæ¨èï¼‰

ä½¿ç”¨ `??` è¿ç®—ç¬¦æ£€æŸ¥å˜é‡æ˜¯å¦å­˜åœ¨ï¼š

```ftl
<#if customMap?? && customMap.projectName??>
 * @project ${customMap.projectName}
</#if>
```

### 3. æ¡ä»¶ç”Ÿæˆä»£ç 

æ ¹æ®å¸ƒå°”å€¼å˜é‡å†³å®šæ˜¯å¦ç”Ÿæˆä»£ç ï¼š

```ftl
<#if customMap?? && customMap.enableLog?? && customMap.enableLog>
import lombok.extern.slf4j.Slf4j;

@Slf4j
</#if>
```

### 4. åœ¨æ–¹æ³•ä¸­ä½¿ç”¨

```ftl
@Override
public UserDTO getById(Long id) {
<#if customMap?? && customMap.enableLog?? && customMap.enableLog>
    log.info("æ ¹æ®IDè·å–ç”¨æˆ·: {}", id);
</#if>
    // ... ä¸šåŠ¡ä»£ç 
}
```

---

## ğŸ¯ å®é™…åº”ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: æ·»åŠ é¡¹ç›®ä¿¡æ¯åˆ°æ³¨é‡Š

**service.java.ftl:**
```ftl
/**
 * <p>
 * ${table.comment!} æœåŠ¡ç±»
 * </p>
 *
 * @author ${author}
 * @since ${date}
<#if customMap?? && customMap.projectName??>
 * @project ${customMap.projectName}
</#if>
<#if customMap?? && customMap.companyName??>
 * @company ${customMap.companyName}
</#if>
<#if customMap?? && customMap.copyright??>
 * ${customMap.copyright}
</#if>
 */
```

**ç”Ÿæˆç»“æœ:**
```java
/**
 * <p>
 * ç”¨æˆ·è¡¨ æœåŠ¡ç±»
 * </p>
 *
 * @author zhuzhiwei
 * @since 2025-12-18
 * @project Spring Template Project
 * @company å¼€å‘å›¢é˜Ÿ
 * Copyright Â© 2025
 */
```

### ç¤ºä¾‹2: æ¡ä»¶æ€§æ·»åŠ æ—¥å¿—åŠŸèƒ½

**serviceImpl.java.ftl:**
```ftl
<#if customMap?? && customMap.enableLog?? && customMap.enableLog>
import lombok.extern.slf4j.Slf4j;
</#if>

<#if customMap?? && customMap.enableLog?? && customMap.enableLog>
@Slf4j
</#if>
@Service
public class UserServiceImpl implements UserService {

    @Override
    public UserDTO getById(Long id) {
<#if customMap?? && customMap.enableLog?? && customMap.enableLog>
        log.info("æ ¹æ®IDè·å–ç”¨æˆ·è¡¨: {}", id);
</#if>
        // ... ä¸šåŠ¡ä»£ç 
    }
}
```

å½“ `enableLog = true` æ—¶ï¼Œç”Ÿæˆçš„ä»£ç ä¼šåŒ…å«æ—¥å¿—åŠŸèƒ½ã€‚

---

## ğŸ“š é»˜è®¤å¯ç”¨å˜é‡

é™¤äº†è‡ªå®šä¹‰å˜é‡ï¼Œæ¨¡æ¿ä¸­è¿˜å¯ä»¥ä½¿ç”¨è¿™äº›é»˜è®¤å˜é‡ï¼š

### åŒ…ç›¸å…³
- `${package.Parent}` - çˆ¶åŒ…åï¼Œå¦‚ï¼šcom.dzy.springtemplate
- `${package.Entity}` - Entity åŒ…å
- `${package.Service}` - Service åŒ…å
- `${package.Controller}` - Controller åŒ…å

### è¡¨ç›¸å…³
- `${table.name}` - æ•°æ®åº“è¡¨åï¼Œå¦‚ï¼šuser
- `${table.comment}` - è¡¨æ³¨é‡Šï¼Œå¦‚ï¼šç”¨æˆ·è¡¨
- `${table.entityName}` - å®ä½“ç±»åï¼Œå¦‚ï¼šUser
- `${table.serviceName}` - Service åç§°ï¼Œå¦‚ï¼šUserService

### å­—æ®µç›¸å…³ï¼ˆåœ¨å¾ªç¯ä¸­ä½¿ç”¨ï¼‰
```ftl
<#list table.fields as field>
    // ${field.name} - ${field.comment}
    private ${field.propertyType} ${field.propertyName};
</#list>
```

### å…¶ä»–
- `${entity}` - å®ä½“ç±»åï¼ˆç®€å†™ï¼‰
- `${author}` - ä½œè€…
- `${date}` - æ—¥æœŸ
- `${swagger}` - æ˜¯å¦å¯ç”¨ Swagger

---

## ğŸ”§ å¦‚ä½•æ·»åŠ æ–°çš„è‡ªå®šä¹‰å˜é‡

### æ­¥éª¤1: åœ¨ CodeGenerator.java ä¸­æ·»åŠ 

```java
Map<String, Object> customMap = new HashMap<>();
customMap.put("myVariable", "æˆ‘çš„è‡ªå®šä¹‰å€¼");
customMap.put("enableFeature", true);
customMap.put("apiPrefix", "/api/v1");

builder.customMap(customMap);
```

### æ­¥éª¤2: åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨

```ftl
<#if customMap?? && customMap.myVariable??>
// è‡ªå®šä¹‰å˜é‡: ${customMap.myVariable}
</#if>

<#if customMap?? && customMap.enableFeature?? && customMap.enableFeature>
// å¯ç”¨æŸåŠŸèƒ½
</#if>

// APIå‰ç¼€: <#if customMap?? && customMap.apiPrefix??>${customMap.apiPrefix}</#if>
```

---

## ğŸ› è°ƒè¯•æŠ€å·§

### 1. æ‰“å°æ‰€æœ‰å˜é‡

åœ¨ CodeGenerator.java ä¸­ï¼š

```java
.beforeOutputFile((tableInfo, objectMap) -> {
    System.out.println("=== æ‰€æœ‰å¯ç”¨å˜é‡ ===");
    objectMap.forEach((key, value) -> {
        System.out.println(key + " = " + value);
    });
})
```

### 2. åœ¨æ¨¡æ¿ä¸­è¾“å‡ºå˜é‡å€¼

```ftl
<!--
DEBUG INFO:
entity = ${entity}
table.name = ${table.name}
customMap.projectName = <#if customMap?? && customMap.projectName??>${customMap.projectName}<#else>æœªå®šä¹‰</#if>
-->
```

---

## ğŸ’¡ å¸¸ç”¨åœºæ™¯

### åœºæ™¯1: ç»Ÿä¸€ç‰ˆæƒä¿¡æ¯

```java
customMap.put("copyright", "Copyright Â© 2025 Your Company");
customMap.put("license", "Apache License 2.0");
```

### åœºæ™¯2: æ§åˆ¶åŠŸèƒ½å¼€å…³

```java
customMap.put("enableSwagger", true);
customMap.put("enableCache", false);
customMap.put("enableValidation", true);
```

### åœºæ™¯3: APIç‰ˆæœ¬ç®¡ç†

```java
customMap.put("apiVersion", "v1");
customMap.put("apiPrefix", "/api/v1");
```

åœ¨ Controller æ¨¡æ¿ä¸­ï¼š
```ftl
@RequestMapping("<#if customMap?? && customMap.apiPrefix??>${customMap.apiPrefix}</#if>/${table.entityPath}")
```

### åœºæ™¯4: å¤šç¯å¢ƒé…ç½®

```java
customMap.put("environment", "dev");
customMap.put("enableDebug", true);
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å˜é‡æ£€æŸ¥**: å§‹ç»ˆä½¿ç”¨ `??` æ£€æŸ¥å˜é‡æ˜¯å¦å­˜åœ¨ï¼Œé¿å…æ¨¡æ¿é”™è¯¯
2. **å¸ƒå°”å€¼**: å¸ƒå°”å€¼éœ€è¦ç”¨ `?c` è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¦‚ `${customMap.enableLog?c}`
3. **null å¤„ç†**: ä½¿ç”¨ `!` æä¾›é»˜è®¤å€¼ï¼Œå¦‚ `${customMap.value!"é»˜è®¤å€¼"}`
4. **å‘½åè§„èŒƒ**: è‡ªå®šä¹‰å˜é‡å»ºè®®ä½¿ç”¨é©¼å³°å‘½åæ³•

---

## ğŸ“ å®Œæ•´ç¤ºä¾‹

æŸ¥çœ‹é¡¹ç›®ä¸­å·²ä¿®æ”¹çš„æ¨¡æ¿æ–‡ä»¶ï¼š
- `service.java.ftl` - æ·»åŠ äº†é¡¹ç›®ä¿¡æ¯æ³¨é‡Š
- `serviceImpl.java.ftl` - æ·»åŠ äº†æ¡ä»¶æ—¥å¿—åŠŸèƒ½

ç”Ÿæˆä»£ç åæŸ¥çœ‹æ•ˆæœï¼

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

- CodeGenerator.java - å˜é‡å®šä¹‰ä½ç½®
- templates/*.ftl - æ¨¡æ¿æ–‡ä»¶
- VARIABLE_TEST.ftl - å˜é‡æµ‹è¯•æ¨¡æ¿ï¼ˆæŸ¥çœ‹æ‰€æœ‰å¯ç”¨å˜é‡ï¼‰
